# 接口文档

**项目名称**：易宿酒店预订平台

**文档版本**：v1.0

**更新时间**：2026-02-03

## 一、通用说明

### 1. 基础信息

- **接口域名(未定，等待后续会议讨论)**：`https://api.xxx.com`（生产环境）；`http://test-api.xxx.com`（测试环境）

- **请求格式**：`application/json`（所有接口均需携带 JSON 格式的请求体/参数）

- **响应格式**：统一返回 `JSON`，结构如下：
  
  ```
  {  
    "code": 200,          // 状态码：200=成功，4xx=客户端错误，5xx=服务端错误  
    "message": "操作成功", // 提示信息  
    "data": {}            // 业务数据（成功时返回，失败时为 null 或空对象）  
  }
  ```

- **公共请求头**（部分接口需额外添加）：
  
  - `Authorization: Bearer {token}`：登录后需在请求头携带 token（有效期 2 小时，过期需重新登录）
  
  - `Content-Type: application/json`（默认已包含，无需重复添加）

### 2. 状态码说明

| code | 含义      | 说明                |
| ---- | ------- | ----------------- |
| 200  | 成功      | 接口调用正常，返回业务数据     |
| 400  | 参数错误    | 请求参数缺失或格式错误       |
| 401  | 未授权     | token 无效/过期，需重新登录 |
| 403  | 权限不足    | 当前用户无操作权限         |
| 404  | 资源不存在   | 请求的接口/数据不存在       |
| 500  | 服务器内部错误 | 后端服务异常，联系运维       |

## 二、接口列表

### 1. 用户登录

- **接口描述**：用户通过账号密码登录，获取登录凭证（token）

- **请求方式**：`POST`

- **接口地址**：`/api/user/login`

- **请求参数**（JSON 格式）：
  
  | 参数名      | 类型     | 是否必填 | 说明        | 示例值                                             |
  | -------- | ------ | ---- | --------- | ----------------------------------------------- |
  | username | string | 是    | 用户名/手机号   | "admin"                                         |
  | password | string | 是    | 密码（MD5加密） | "e10adc3949ba59abbe56e057f20f883e"（对应明文 123456） |

- **请求示例**：
  
  ```
  curl -X POST https://api.xxx.com/api/user/login \  
  -H "Content-Type: application/json" \  
  -d '{"username":"admin","password":"e10adc3949ba59abbe56e057f20f883e"}'
  ```

- **响应示例**（成功）：
  
  ```
  {  
    "code": 200,  
    "message": "登录成功",  
    "data": {  
      "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...", // JWT Token  
      "userInfo": {  
        "userId": 1001,  
        "username": "admin",  
        "nickname": "管理员",  
        "avatar": "https://xxx.com/avatar/admin.jpg"  
      },  
      "expireTime": 7200 // token 有效期（秒）  
    }  
  }
  ```

- **响应示例**（失败，密码错误）：
  
  ```
  {  
    "code": 400,  
    "message": "用户名或密码错误",  
    "data": null  
  }
  ```

### 2. 获取用户信息

- **接口描述**：登录后获取当前用户的详细信息（需携带 token）

- **请求方式**：`GET`

- **接口地址**：`/api/user/info`

- **请求头**：需携带 `Authorization: Bearer {token}`（从登录接口的 data.token 获取）

- **请求参数**：无（通过 token 识别用户身份）

- **请求示例**：
  
  ```
  curl -X GET https://api.xxx.com/api/user/info \  
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  ```

- **响应示例**（成功）：
  
  ```
  {  
    "code": 200,  
    "message": "获取成功",  
    "data": {  
      "userId": 1001,  
      "username": "admin",  
      "nickname": "管理员",  
      "email": "admin@xxx.com",  
      "phone": "13800138000",  
      "role": "super_admin", // 角色：super_admin=超级管理员，admin=普通管理员，user=普通用户  
      "createTime": "2023-01-01 10:00:00"  
    }  
  }
  ```

- **响应示例**（失败，token 过期）：
  
  ```
  {  
    "code": 401,  
    "message": "token 已过期，请重新登录",  
    "data": null  
  }
  ```

### 3. 退出登录

- **接口描述**：销毁当前用户的 token，使登录状态失效

- **请求方式**：`POST`

- **接口地址**：`/api/user/logout`

- **请求头**：需携带 `Authorization: Bearer {token}`

- **请求参数**：无

- **请求示例**：
  
  ```
  curl -X POST https://api.xxx.com/api/user/logout \  
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  ```

- **响应示例**（成功）：
  
  ```
  {  
    "code": 200,  
    "message": "退出登录成功",  
    "data": null  
  }
  ```

## 三、注意事项

1. 所有接口的 `Content-Type`默认为 `application/json`，请勿修改为 `form-data`或 `x-www-form-urlencoded`（除非接口特别说明）。

2. token 有效期为 2 小时，前端需在 token 过期前主动调用刷新 token 接口（若有），或引导用户重新登录。

3. 密码需在前端进行 MD5 加密后再传给后端（避免明文传输），加密规则：`MD5(原始密码)`。

4. 若接口返回 `5xx`错误，可能是后端服务异常，建议重试 1-2 次，仍失败则联系后端排查。

---

**备注**：本文档会根据后端接口变更同步更新，最新版本以 Git 仓库为准。
